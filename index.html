<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Untuk Safna ğŸ¤</title>

<style>
body{
margin:0;
font-family:sans-serif;
text-align:center;
background:linear-gradient(135deg,#ffdde1,#ee9ca7);
overflow:hidden;
color:#333;
}

section{
display:none;
padding:20px;
}

#passwordPage{display:block;}

input{
padding:10px;
border-radius:10px;
border:none;
margin-top:10px;
}

button{
padding:10px 20px;
border:none;
border-radius:20px;
background:#ff4d6d;
color:white;
margin-top:10px;
}

#clue{
margin-top:20px;
animation:blink 1s infinite;
cursor:pointer;
}

@keyframes blink{
0%{opacity:1;}
50%{opacity:0.3;}
100%{opacity:1;}
}

#loadingBar{
width:80%;
height:20px;
background:white;
border-radius:20px;
margin:20px auto;
overflow:hidden;
}

#progress{
height:100%;
width:0%;
background:#ff4d6d;
}

#finalHeart{
width:90px;
height:90px;
border-radius:50%;
object-fit:cover;
position:absolute;
cursor:pointer;
box-shadow:0 5px 15px rgba(0,0,0,0.3);
}

@keyframes shake{
0%{transform:rotate(0deg);}
25%{transform:rotate(-10deg);}
50%{transform:rotate(10deg);}
75%{transform:rotate(-10deg);}
100%{transform:rotate(0deg);}
}

.shake{
animation:shake 0.3s;
}

canvas{
position:fixed;
top:0;
left:0;
pointer-events:none;
}
</style>
</head>

<body>

<!-- PASSWORD -->
<section id="passwordPage">
<h2>Masukin Password Dulu ğŸ’Œ</h2>
<input type="password" id="passwordInput">
<br>
<button onclick="checkPassword()">Masuk</button>
<div id="clue" onclick="showClue()">Clue? ğŸ¤­</div>
<p id="clueText"></p>
</section>

<!-- LOADING -->
<section id="loadingPage">
<h2>Loading Cinta... ğŸ’›</h2>
<p>Aktifkan Sensor Cinta dulu yaa</p>
<button onclick="activateSensor()">Aktifkan Sensor Cinta ğŸ’›</button>
<div id="loadingBar"><div id="progress"></div></div>
</section>

<!-- GAME -->
<section id="gamePage">
<h2>Happy Birthday Safna ğŸ‚</h2>
<p>Klik muka Safna 15x yaa ğŸ˜†</p>
<p>Score: <span id="score">0</span></p>
<img id="finalHeart" src="safna.jpg">
</section>

<!-- CAKE -->
<section id="cakePage">
<h2>Tiup Lilinnya ğŸ‚</h2>
<p>Tiup mic HP kamu yaaa ğŸ˜†</p>
<h1 id="candle">ğŸ•¯ï¸</h1>
<h2 id="finalMessage" style="display:none;">
Selamat ulang tahun ya, Safna ğŸ¤<br><br>
Semoga semua doa baik yang kamu simpan diam-diam satu per satu jadi nyata.<br><br>
Semoga kamu selalu dikelilingi hal-hal yang bikin kamu senyumâ€¦<br>
walaupun jujur, aku berharap aku bisa jadi salah satu alasannya ğŸ˜Œâœ¨<br><br>
Hari ini Safna bertambah umur,<br>
tapi tenang ajaâ€¦ kamu tetap manis kok, nggak nambah tua, cuma nambah spesial buat aku ğŸ’›
</h2>
</section>

<audio id="birthdaySong" src="https://www2.cs.uic.edu/~i101/SoundFiles/HappyBirthday.mid"></audio>
<audio id="ehSound" src="https://www.myinstants.com/media/sounds/anime-wow-sound-effect.mp3"></audio>

<script>
let progress=0;
let interval;
let score=0;
let target=15;

function checkPassword(){
if(document.getElementById("passwordInput").value==="SayangFikri"){
document.getElementById("passwordPage").style.display="none";
document.getElementById("loadingPage").style.display="block";
}else{
alert("Salah ğŸ˜œ");
}
}

function showClue(){
document.getElementById("clueText").innerText="Cluenya... mungkin ada kata Sayang dan nama kamu ğŸ˜";
}

function activateSensor(){
window.addEventListener("deviceorientation",handleOrientation);
interval=setInterval(normalLoad,100);
}

function normalLoad(){
if(progress<100){
progress+=1;
updateProgress();
}
}

function handleOrientation(event){
let tilt=event.gamma;
if(tilt>10) progress+=3;
if(tilt<-10) progress-=2;
if(progress<0)progress=0;
if(progress>100)progress=100;
updateProgress();
}

function updateProgress(){
document.getElementById("progress").style.width=progress+"%";
if(progress>=100){
clearInterval(interval);
startGame();
}
}

function startGame(){
document.getElementById("loadingPage").style.display="none";
document.getElementById("gamePage").style.display="block";
document.getElementById("birthdaySong").play().catch(()=>{});
}

const heart=document.getElementById("finalHeart");
const ehSound=document.getElementById("ehSound");

heart.onclick=function(){
score++;
document.getElementById("score").innerText=score;

ehSound.currentTime=0;
ehSound.play().catch(()=>{});

heart.classList.add("shake");
setTimeout(()=>heart.classList.remove("shake"),300);

heart.style.top=Math.random()*(window.innerHeight-100)+"px";
heart.style.left=Math.random()*(window.innerWidth-100)+"px";

if(score>=target){
document.getElementById("gamePage").style.display="none";
document.getElementById("cakePage").style.display="block";
startMic();
}
};

function startMic(){
navigator.mediaDevices.getUserMedia({audio:true}).then(stream=>{
const audioContext=new AudioContext();
const analyser=audioContext.createAnalyser();
const mic=audioContext.createMediaStreamSource(stream);
mic.connect(analyser);
const data=new Uint8Array(analyser.frequencyBinCount);

function detect(){
analyser.getByteFrequencyData(data);
let volume=data.reduce((a,b)=>a+b)/data.length;
if(volume>50){
document.getElementById("candle").innerText="ğŸ’¨";
document.getElementById("finalMessage").style.display="block";
}
requestAnimationFrame(detect);
}
detect();
});
}
</script>

</body>
</html>
